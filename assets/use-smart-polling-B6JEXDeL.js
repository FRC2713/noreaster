import{c as y}from"./query-vendor-BivveeUn.js";import{r as t}from"./react-vendor-CNeAGCso.js";function A({queryKey:d,queryFn:m,refetchInterval:r=3e4,staleTime:v=1e4,gcTime:h=600*1e3,enabled:l=!0,onError:a}){const o=t.useRef(Date.now()),f=t.useRef(!0),n=t.useRef(0),s=t.useCallback(()=>{o.current=Date.now()},[]);return t.useEffect(()=>{const e=()=>{f.current=!document.hidden,document.hidden||s()},c=()=>{s()},i=["mousedown","mousemove","keypress","scroll","touchstart","click"];return i.forEach(u=>{document.addEventListener(u,c,{passive:!0})}),document.addEventListener("visibilitychange",e),()=>{i.forEach(u=>{document.removeEventListener(u,c)}),document.removeEventListener("visibilitychange",e)}},[s]),{...y({queryKey:d,queryFn:async()=>{try{const e=await m();return n.current=0,e}catch(e){throw n.current+=1,a&&e instanceof Error&&a(e),e}},refetchInterval:()=>{const c=Date.now()-o.current<6e4,i=n.current>0;return f.current?i?Math.min(r*2,12e4):c?r:r*2:r*4},refetchIntervalInBackground:!0,staleTime:v,gcTime:h,enabled:l,refetchOnWindowFocus:!1,refetchOnMount:!0}),isActive:Date.now()-o.current<6e4,errorCount:n.current}}export{A as u};
