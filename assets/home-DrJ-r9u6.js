import{j as s,r as x,L as c}from"./index-BmdevC1f.js";import{B as h}from"./button-0VHX3KvR.js";import{C as b,a as f,b as v,c as I}from"./card--BeEpeTn.js";import{M as N}from"./match-card-D-OLAk7v.js";import{u as w}from"./use-matches-polling-C0trMDUD.js";import{u as T}from"./use-alliances-polling-C7wt8F3W.js";import{M}from"./matches-status-D5cxs7WY.js";import{g as o}from"./matches-store-DsfI4gDF.js";import{c as E}from"./rankings-2yAB9IBR.js";import"./useQuery-Cgu6KS9_.js";import"./react-yI-qG6nv.js";function u({title:l,right:r,children:i,className:d}){return s.jsxs(b,{className:d,children:[s.jsxs(f,{className:"flex flex-row items-center justify-between",children:[s.jsx(v,{className:"text-lg font-semibold",children:l}),r]}),s.jsx(I,{children:i})]})}function S({title:l,actions:r,className:i}){return s.jsxs("div",{className:`flex items-center justify-between ${i??""}`,children:[s.jsx("h1",{className:"text-2xl font-semibold",children:l}),r]})}function P(){const{alliances:l}=T(),{matches:r,isLoading:i,error:d}=w();function n(e){return l.find(t=>t.id===e)?.name??e}const p=x.useMemo(()=>E(l,r.map(e=>({red_alliance_id:e.red_alliance_id,blue_alliance_id:e.blue_alliance_id,red_score:e.red_score,blue_score:e.blue_score,red_coral_rp:!!e.red_coral_rp,red_auto_rp:!!e.red_auto_rp,red_barge_rp:!!e.red_barge_rp,blue_coral_rp:!!e.blue_coral_rp,blue_auto_rp:!!e.blue_auto_rp,blue_barge_rp:!!e.blue_barge_rp}))).slice(0,8),[l,r]),_=x.useMemo(()=>{const e=r.filter(t=>t.red_score==null&&t.blue_score==null);return e.sort((t,a)=>{const m=t.scheduled_at?new Date(t.scheduled_at).getTime():Number.NEGATIVE_INFINITY,j=a.scheduled_at?new Date(a.scheduled_at).getTime():Number.NEGATIVE_INFINITY;return m-j}),e.slice(0,10)},[r]),g=x.useMemo(()=>{const e=r.filter(t=>t.red_score!=null&&t.blue_score!=null);return e.sort((t,a)=>{const m=t.scheduled_at?new Date(t.scheduled_at).getTime():Number.NEGATIVE_INFINITY;return(a.scheduled_at?new Date(a.scheduled_at).getTime():Number.NEGATIVE_INFINITY)-m}),e.slice(0,5)},[r]);return s.jsxs("div",{className:"space-y-6",children:[s.jsx(S,{title:"Dashboard",actions:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(M,{}),s.jsx(c,{to:"/matches",children:s.jsx(h,{variant:"outline",children:"Matches"})}),s.jsx(c,{to:"/rankings",children:s.jsx(h,{variant:"outline",children:"Rankings"})}),s.jsx(c,{to:"/schedule",children:s.jsx(h,{variant:"outline",children:"Schedule"})})]})}),s.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[s.jsxs(u,{title:"Upcoming Matches",right:s.jsx(c,{to:"/matches/preview",className:"text-sm underline",children:"Preview"}),children:[i&&s.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading…"}),d&&s.jsx("div",{className:"text-sm text-red-600",children:String(d)}),!i&&!d&&(_.length===0?s.jsx("div",{className:"text-sm text-muted-foreground",children:"No upcoming matches."}):s.jsx("ul",{className:"grid gap-2",children:_.map(e=>{const t=o(e.red,n(e.red_alliance_id)),a=o(e.blue,n(e.blue_alliance_id));return s.jsx("li",{children:s.jsx(N,{title:e.name??void 0,scheduledAt:e.scheduled_at,redName:t,blueName:a,redScore:e.red_score,blueScore:e.blue_score,showRelativeTime:!0,editHref:`/matches/${e.id}`,matchId:e.id})},e.id)})}))]}),s.jsxs(u,{title:"Recent Matches",children:[i&&s.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading…"}),d&&s.jsx("div",{className:"text-sm text-red-600",children:String(d)}),!i&&!d&&(g.length===0?s.jsx("div",{className:"text-sm text-muted-foreground",children:"No recent matches."}):s.jsx("ul",{className:"grid gap-2",children:g.map(e=>{const t=o(e.red,n(e.red_alliance_id)),a=o(e.blue,n(e.blue_alliance_id));return s.jsx("li",{children:s.jsx(N,{title:e.name??void 0,scheduledAt:e.scheduled_at,redName:t,blueName:a,redScore:e.red_score,blueScore:e.blue_score,showRelativeTime:!0,editHref:`/matches/${e.id}`,matchId:e.id})},e.id)})}))]})]}),s.jsxs(u,{title:"Top Rankings",children:[s.jsx("div",{className:"grid gap-2",children:p.map(e=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"text-sm font-mono text-muted-foreground w-8",children:e.rank}),s.jsx("div",{className:"font-medium",children:e.name})]}),s.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.avgRp.toFixed(3)," RP • ",e.avgScore.toFixed(1)," pts"]})]},e.id))}),s.jsx("div",{className:"mt-4 pt-4 border-t",children:s.jsx(c,{to:"/rankings",className:"text-sm underline",children:"View all rankings"})})]}),s.jsxs(u,{title:"Alliances",children:[s.jsx("div",{className:"grid gap-2",children:l.slice(0,8).map(e=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(c,{to:`/alliances/${e.id}`,className:"font-medium hover:underline",children:e.name}),s.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.teams.filter(Boolean).length," teams"]})]},e.id))}),s.jsx("div",{className:"mt-4 pt-4 border-t",children:s.jsx(c,{to:"/alliances",className:"text-sm underline",children:"View all alliances"})})]})]})}export{P as default};
