import{j as e,x as K,y as T}from"./ui-vendor-CDBhOMS0.js";import{r,k as U,L as $}from"./react-vendor-CNeAGCso.js";import{c as L,B as Q,s as F}from"./index-eDSu_bsY.js";import{u as z,b as D}from"./query-vendor-BivveeUn.js";import{u as G}from"./use-alliances-polling-D0xxy3GB.js";import{u as H}from"./use-match-CqNIaCfd.js";import"./supabase-vendor-B8N91wlh.js";import"./utils-vendor-DCj5grse.js";import"./icons-vendor-Db1BlRWD.js";const u=r.forwardRef(({className:t,...l},n)=>e.jsx(K,{ref:n,className:L("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...l,children:e.jsx(T,{className:L("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));u.displayName=K.displayName;function I({title:t,coral:l,auto:n,barge:s,onCoralChange:m,onAutoChange:c,onBargeChange:o,className:i}){return e.jsxs("div",{className:`${i??""} border rounded-md p-4`,children:[e.jsx("div",{className:"font-semibold mb-3 text-lg",children:t}),e.jsxs("label",{className:"flex items-center justify-between py-2 text-lg",children:[e.jsx("span",{children:"Coral RP"}),e.jsx(u,{checked:l,onCheckedChange:m})]}),e.jsxs("label",{className:"flex items-center justify-between py-2 text-lg",children:[e.jsx("span",{children:"Auto RP"}),e.jsx(u,{checked:n,onCheckedChange:c})]}),e.jsxs("label",{className:"flex items-center justify-between py-2 text-lg",children:[e.jsx("span",{children:"Barge RP"}),e.jsx(u,{checked:s,onCheckedChange:o})]})]})}function ae(){const{matchId:t}=U(),l=z(),{alliances:n}=G(),{data:s,isLoading:m,error:c}=H(t),[o,i]=r.useState(""),[g,h]=r.useState(""),[b,p]=r.useState(""),[x,f]=r.useState(""),[j,_]=r.useState(!1),[v,S]=r.useState(!1),[N,y]=r.useState(!1),[C,k]=r.useState(!1),[w,A]=r.useState(!1),[B,R]=r.useState(!1),[P,M]=r.useState(null);r.useEffect(()=>{s&&(i(s.red_score!=null?String(s.red_score):""),h(s.blue_score!=null?String(s.blue_score):""),p(s.red_auto_score!=null?String(s.red_auto_score):""),f(s.blue_auto_score!=null?String(s.blue_auto_score):""),_(!!s.red_coral_rp),S(!!s.red_auto_rp),y(!!s.red_barge_rp),k(!!s.blue_coral_rp),A(!!s.blue_auto_rp),R(!!s.blue_barge_rp))},[s]);const E=D({mutationFn:async()=>{if(!t)return;const a={red_score:o?Number(o):null,blue_score:g?Number(g):null,red_auto_score:b?Number(b):null,blue_auto_score:x?Number(x):null,red_coral_rp:j,red_auto_rp:v,red_barge_rp:N,blue_coral_rp:C,blue_auto_rp:w,blue_barge_rp:B},{error:d}=await F.from("matches").update(a).eq("id",t);if(d)throw d},onSuccess:()=>{M("Saved."),l.invalidateQueries({queryKey:["matches","polling"]}),l.invalidateQueries({queryKey:["matches","byId",t]})},onError:a=>M(`Save failed: ${a?.message??"Unknown error"}`)});function q(a){return a?n.find(d=>d.id===a)?.name??a:"Unknown Alliance"}return t?m?e.jsx("p",{children:"Loading match…"}):c?e.jsxs("p",{className:"text-red-600",children:["Error: ",String(c)]}):s?e.jsxs("div",{className:"space-y-6 max-w-3xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($,{to:"/matches",children:e.jsx(Q,{variant:"ghost",children:"← Back"})}),e.jsx("h1",{className:"text-2xl font-semibold",children:s.name??"Edit Match"})]}),e.jsxs("div",{className:"rounded-md border p-4",children:[e.jsxs("div",{className:"mb-4 font-semibold text-xl",children:[q(s.red_alliance_id)," vs"," ",q(s.blue_alliance_id)]}),e.jsxs("div",{className:"grid sm:grid-cols-2 gap-4 text-lg",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium",children:"Red Score"}),e.jsx("input",{type:"number",value:o,onChange:a=>i(a.target.value),className:"w-full rounded-md border px-3 py-3 text-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium",children:"Blue Score"}),e.jsx("input",{type:"number",value:g,onChange:a=>h(a.target.value),className:"w-full rounded-md border px-3 py-3 text-lg"})]})]}),e.jsxs("div",{className:"grid sm:grid-cols-2 gap-4 text-lg mt-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium",children:"Red Auto Score"}),e.jsx("input",{type:"number",value:b,onChange:a=>p(a.target.value),className:"w-full rounded-md border px-3 py-3 text-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium",children:"Blue Auto Score"}),e.jsx("input",{type:"number",value:x,onChange:a=>f(a.target.value),className:"w-full rounded-md border px-3 py-3 text-lg"})]})]})]}),e.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[e.jsx(I,{title:"Red Alliance RP",coral:j,auto:v,barge:N,onCoralChange:_,onAutoChange:S,onBargeChange:y}),e.jsx(I,{title:"Blue Alliance RP",coral:C,auto:w,barge:B,onCoralChange:k,onAutoChange:A,onBargeChange:R})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Q,{onClick:()=>E.mutate(),disabled:E.isPending,children:"Save"}),P&&e.jsx("span",{className:"text-sm opacity-80",children:P})]})]}):e.jsx("p",{children:"Match not found"}):e.jsx("p",{children:"Missing match id"})}export{ae as default};
