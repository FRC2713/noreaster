import{j as e}from"./ui-vendor-CDBhOMS0.js";import{r as N,L as w}from"./react-vendor-CNeAGCso.js";import{B as j}from"./badge-BBSCdzdz.js";import{C as p,a as v}from"./card-C15IIjEe.js";import{C as $,a as _,T as h}from"./icons-vendor-Db1BlRWD.js";import{u as y}from"./use-matches-polling-Cf3FAkTn.js";import{u as A}from"./use-alliances-polling-DUy60FBv.js";import{S as b}from"./skeleton-Cxzs5sQr.js";import"./index-BKCnwC9K.js";import"./supabase-vendor-B8N91wlh.js";import"./utils-vendor-DCj5grse.js";import"./query-vendor-BivveeUn.js";import"./use-smart-polling-B6JEXDeL.js";function C(x){const l=new Date(x).getTime(),i=Date.now(),m=Math.round((l-i)/1e3),d=Math.abs(m),t=60,o=60*t,u=24*o;let s,a;d<o?(s=Math.max(1,Math.round(d/t)),a="min"):d<u?(s=Math.max(1,Math.round(d/o)),a="hr"):(s=Math.max(1,Math.round(d/u)),a=s===1?"day":"days");const c=`${s} ${a}`;return m>0?`in ${c}`:m<0?`${c} ago`:"now"}const R=N.memo(function({match:l,right:i,showRelativeTime:m=!1,dense:d=!1}){if(!l)return null;const t="redAlliance"in l?l.redAlliance:null,o="blueAlliance"in l?l.blueAlliance:null,u=Array.isArray(l.red)?l.red.map(n=>n.name).join(", "):l.red?.name||t?.name||l.red_alliance_id,s=Array.isArray(l.blue)?l.blue.map(n=>n.name).join(", "):l.blue?.name||o?.name||l.blue_alliance_id;let a="Unscheduled",c=e.jsx($,{className:"w-4 h-4"}),r="text-muted-foreground";if(l.scheduled_at)if(m){const n=new Date(l.scheduled_at).getTime(),g=Math.abs(n-Date.now()),M=720*60*1e3;a=g>M?new Date(l.scheduled_at).toLocaleString():C(l.scheduled_at),g<3600*1e3?(r="text-red-600",c=e.jsx(_,{className:"w-4 h-4"})):g<7200*1e3?(r="text-orange-600",c=e.jsx(_,{className:"w-4 h-4"})):g<360*60*1e3&&(r="text-yellow-600",c=e.jsx(_,{className:"w-4 h-4"}))}else a=new Date(l.scheduled_at).toLocaleString();if(d){const n=e.jsx(p,{className:"group transition-all duration-200 hover:shadow-md hover:scale-[1.02] cursor-pointer",children:e.jsxs(v,{className:"p-4 text-sm flex flex-col gap-3",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("h3",{className:"text-base font-semibold text-foreground",children:l.name?.replace("Round ","R").replace("Match ","M")})})})}),e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2 p-2 rounded-md bg-red-50/50 dark:bg-red-950/10 flex-1",children:[e.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden bg-muted flex-shrink-0 shadow-sm",children:t?.emblem_image_url?e.jsx("img",{src:t.emblem_image_url,alt:`${t.name} emblem`,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full grid place-items-center text-sm text-muted-foreground font-bold",children:"R"})}),e.jsx("h4",{className:"font-medium text-sm text-red-900 dark:text-red-100 text-center",children:u})]}),e.jsx("div",{className:"flex items-center gap-2 text-muted-foreground",children:e.jsx("span",{className:"text-sm font-medium",children:"VS"})}),e.jsxs("div",{className:"flex flex-col items-center gap-2 p-2 rounded-md bg-blue-50/50 dark:bg-blue-950/10 flex-1",children:[e.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden bg-muted flex-shrink-0 shadow-sm",children:o?.emblem_image_url?e.jsx("img",{src:o.emblem_image_url,alt:`${o.name} emblem`,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full grid place-items-center text-sm text-muted-foreground font-bold",children:"B"})}),e.jsx("h4",{className:"font-medium text-sm text-blue-900 dark:text-blue-100 text-center",children:s})]})]}),i&&e.jsx("div",{className:"flex items-center justify-end gap-2",children:e.jsx("div",{onClick:g=>g.stopPropagation(),children:i})})]})});return l.id?e.jsx(w,{to:`/matches/details/${l.id}`,className:"block no-underline",children:n}):n}const f=e.jsx(p,{className:"group transition-all duration-200 hover:shadow-md hover:scale-[1.02] cursor-pointer min-h-[160px]",children:e.jsxs(v,{className:"p-6 text-base flex flex-col gap-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-4",children:l.name&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"text-xl font-bold text-foreground",children:l.name}),l.round&&l.match_number&&e.jsxs(j,{className:"text-sm px-3 py-1 h-7 font-medium",children:["R",l.round,"M",l.match_number]})]})}),e.jsxs("div",{className:`flex items-center gap-2 ${r}`,children:[c,e.jsx("span",{className:"text-base font-medium",children:a})]})]}),e.jsxs("div",{className:"flex items-center justify-center gap-8",children:[e.jsxs("div",{className:"flex flex-col items-center gap-4 p-6 rounded-xl bg-red-50/50 dark:bg-red-950/10 min-w-[14rem]",children:[e.jsx("div",{className:"w-20 h-20 rounded-full overflow-hidden bg-muted flex-shrink-0 shadow-sm",children:t?.emblem_image_url?e.jsx("img",{src:t.emblem_image_url,alt:`${t.name} emblem`,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full grid place-items-center text-2xl text-muted-foreground font-bold",children:"R"})}),e.jsx("h4",{className:"font-bold text-xl text-red-900 dark:text-red-100 text-center max-w-[12rem] leading-tight",children:u}),e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"})]}),e.jsx("div",{className:"flex flex-col items-center gap-3",children:e.jsx("div",{className:"text-2xl font-bold text-muted-foreground",children:"VS"})}),e.jsxs("div",{className:"flex flex-col items-center gap-4 p-6 rounded-xl bg-blue-50/50 dark:bg-blue-950/10 min-w-[14rem]",children:[e.jsx("div",{className:"w-20 h-20 rounded-full overflow-hidden bg-muted flex-shrink-0 shadow-sm",children:o?.emblem_image_url?e.jsx("img",{src:o.emblem_image_url,alt:`${o.name} emblem`,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full grid place-items-center text-2xl text-muted-foreground font-bold",children:"B"})}),e.jsx("h4",{className:"font-bold text-xl text-blue-900 dark:text-blue-100 text-center max-w-[12rem] leading-tight",children:s}),e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"})]})]}),e.jsx("div",{className:"flex items-center justify-end gap-3",children:i?e.jsx("div",{onClick:n=>n.stopPropagation(),children:i}):null})]})});return l.id?e.jsx(w,{to:`/matches/details/${l.id}`,className:"block no-underline",children:f}):f}),S=N.memo(function({match:l,right:i,dense:m=!1}){const d="redAlliance"in l?l.redAlliance:null,t="blueAlliance"in l?l.blueAlliance:null;if(!l)return null;const o=Array.isArray(l.red)?l.red.map(n=>n.name).join(", "):l.red?.name||d?.name||l.red_alliance_id,u=Array.isArray(l.blue)?l.blue.map(n=>n.name).join(", "):l.blue?.name||t?.name||l.blue_alliance_id,s=l.red_score!==void 0&&l.red_score!==null&&l.blue_score!==void 0&&l.blue_score!==null,a=s&&l.red_score>l.blue_score,c=s&&l.blue_score>l.red_score,r=s&&l.red_score===l.blue_score;if(m){const n=e.jsx(p,{className:"group transition-all duration-200 hover:shadow-md hover:scale-[1.02] cursor-pointer",children:e.jsxs(v,{className:"p-4 text-sm flex flex-col gap-3",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("h3",{className:"text-base font-semibold text-foreground",children:l.name?.replace("Round ","R").replace("Match ","M")})})})}),e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:`flex flex-col items-center gap-2 p-2 rounded-md transition-all duration-200 flex-1 ${a?"bg-red-50 dark:bg-red-950/30 border border-red-200":"bg-red-50/50 dark:bg-red-950/10"}`,children:[e.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden bg-muted flex-shrink-0 shadow-sm",children:d?.emblem_image_url?e.jsx("img",{src:d.emblem_image_url,alt:`${d.name} emblem`,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full grid place-items-center text-sm text-muted-foreground font-bold",children:"R"})}),e.jsx("h4",{className:"font-medium text-sm text-red-900 dark:text-red-100 text-center",children:o}),s&&e.jsx("div",{className:`text-lg font-bold ${a?"text-red-700 dark:text-red-300":"text-red-600 dark:text-red-400"}`,children:l.red_score})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx("span",{className:"text-sm font-medium",children:"VS"}),s&&e.jsxs("div",{className:"flex items-center gap-1",children:[a&&e.jsx(h,{className:"w-4 h-4 text-yellow-500"}),r&&e.jsx("span",{className:"text-xs font-bold text-yellow-600",children:"TIE"}),c&&e.jsx(h,{className:"w-4 h-4 text-yellow-500"})]})]}),e.jsxs("div",{className:`flex flex-col items-center gap-2 p-2 rounded-md transition-all duration-200 flex-1 ${c?"bg-blue-50 dark:bg-blue-950/30 border border-blue-200":"bg-blue-50/50 dark:bg-blue-950/10"}`,children:[e.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden bg-muted flex-shrink-0 shadow-sm",children:t?.emblem_image_url?e.jsx("img",{src:t.emblem_image_url,alt:`${t.name} emblem`,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full grid place-items-center text-sm text-muted-foreground font-bold",children:"B"})}),e.jsx("h4",{className:"font-medium text-sm text-blue-900 dark:text-blue-100 text-center",children:u}),s&&e.jsx("div",{className:`text-lg font-bold ${c?"text-blue-700 dark:text-blue-300":"text-blue-600 dark:text-blue-400"}`,children:l.blue_score})]})]}),i&&e.jsx("div",{className:"flex items-center justify-end gap-2",children:e.jsx("div",{onClick:g=>g.stopPropagation(),children:i})})]})});return l.id?e.jsx(w,{to:`/matches/details/${l.id}`,className:"block no-underline",children:n}):n}const f=e.jsx(p,{className:"group transition-all duration-200 hover:shadow-md hover:scale-[1.02] cursor-pointer min-h-[160px]",children:e.jsxs(v,{className:"p-6 text-base flex flex-col gap-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-4",children:l.name&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"text-xl font-bold text-foreground",children:l.name}),l.round&&l.match_number&&e.jsxs(j,{className:"text-sm px-3 py-1 h-7 font-medium",children:["R",l.round,"M",l.match_number]})]})}),s&&e.jsxs("div",{className:"flex items-center gap-2",children:[a&&e.jsxs(j,{className:"bg-red-100 text-red-800 border-red-200 dark:bg-red-900/30 dark:text-red-200 dark:border-red-800",children:[e.jsx(h,{className:"w-4 h-4 mr-1 text-red-600"}),"Red Wins"]}),c&&e.jsxs(j,{className:"bg-blue-100 text-blue-800 border-blue-200 dark:bg-blue-900/30 dark:text-blue-200 dark:border-blue-800",children:[e.jsx(h,{className:"w-4 h-4 mr-1 text-blue-600"}),"Blue Wins"]}),r&&e.jsx(j,{className:"bg-yellow-100 text-yellow-800 border-yellow-200 dark:bg-yellow-900/30 dark:text-yellow-200 dark:border-yellow-800",children:"Tie Game"})]})]}),e.jsxs("div",{className:"flex items-center justify-center gap-8",children:[e.jsx("div",{className:"flex flex-col items-center gap-3 min-w-[8rem]",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsxs("div",{className:`flex items-center gap-2 text-lg font-medium ${l.red_coral_rp?"text-foreground":"text-muted-foreground/50"}`,children:[l.red_coral_rp&&e.jsx("span",{className:"text-green-600",children:"✓"}),e.jsx("span",{children:"Coral"})]}),e.jsxs("div",{className:`flex items-center gap-2 text-lg font-medium ${l.red_auto_rp?"text-foreground":"text-muted-foreground/50"}`,children:[l.red_auto_rp&&e.jsx("span",{className:"text-green-600",children:"✓"}),e.jsx("span",{children:"Auto"})]}),e.jsxs("div",{className:`flex items-center gap-2 text-lg font-medium ${l.red_barge_rp?"text-foreground":"text-muted-foreground/50"}`,children:[l.red_barge_rp&&e.jsx("span",{className:"text-green-600",children:"✓"}),e.jsx("span",{children:"Barge"})]})]})}),e.jsxs("div",{className:`
            flex flex-col items-center gap-4 p-6 rounded-xl transition-all duration-200
            ${a?"bg-red-50 dark:bg-red-950/30 shadow-md border-2 border-red-200":"bg-red-50/50 dark:bg-red-950/10"}
            min-w-[14rem]
          `,children:[e.jsx("div",{className:"w-20 h-20 rounded-full overflow-hidden bg-muted flex-shrink-0 shadow-sm",children:d?.emblem_image_url?e.jsx("img",{src:d.emblem_image_url,alt:`${d.name} emblem`,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full grid place-items-center text-2xl text-muted-foreground font-bold",children:"R"})}),e.jsx("h4",{className:"font-bold text-xl text-red-900 dark:text-red-100 text-center max-w-[12rem] leading-tight",children:o}),s&&e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("div",{className:`
                  text-4xl font-bold
                  ${a?"text-red-700 dark:text-red-300":"text-red-600 dark:text-red-400"}
                `,children:l.red_score}),l.red_auto_score!==null&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Auto: ",l.red_auto_score]})]}),e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"})]}),e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"text-2xl font-bold text-muted-foreground",children:"VS"}),s&&e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[a&&e.jsx(h,{className:"w-8 h-8 text-yellow-500"}),r&&e.jsx("span",{className:"text-lg font-bold text-yellow-600",children:"TIE"}),c&&e.jsx(h,{className:"w-8 h-8 text-yellow-500"})]})]}),e.jsxs("div",{className:`
            flex flex-col items-center gap-4 p-6 rounded-xl transition-all duration-200
            ${c?"bg-blue-50 dark:bg-blue-950/30 shadow-md border-2 border-blue-200":"bg-blue-50/50 dark:bg-blue-950/10"}
            min-w-[14rem]
          `,children:[e.jsx("div",{className:"w-20 h-20 rounded-full overflow-hidden bg-muted flex-shrink-0 shadow-sm",children:t?.emblem_image_url?e.jsx("img",{src:t.emblem_image_url,alt:`${t.name} emblem`,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full grid place-items-center text-2xl text-muted-foreground font-bold",children:"B"})}),e.jsx("h4",{className:"font-bold text-xl text-blue-900 dark:text-blue-100 text-center max-w-[12rem] leading-tight",children:u}),s&&e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("div",{className:`
                  text-4xl font-bold
                  ${c?"text-blue-700 dark:text-blue-300":"text-blue-600 dark:text-blue-400"}
                `,children:l.blue_score}),l.blue_auto_score!==null&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Auto: ",l.blue_auto_score]})]}),e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"})]}),e.jsx("div",{className:"flex flex-col items-center gap-3 min-w-[8rem]",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsxs("div",{className:`flex items-center gap-2 text-lg font-medium ${l.blue_coral_rp?"text-foreground":"text-muted-foreground/50"}`,children:[e.jsx("span",{children:"Coral"}),l.blue_coral_rp&&e.jsx("span",{className:"text-green-600",children:"✓"})]}),e.jsxs("div",{className:`flex items-center gap-2 text-lg font-medium ${l.blue_auto_rp?"text-foreground":"text-muted-foreground/50"}`,children:[e.jsx("span",{children:"Auto"}),l.blue_auto_rp&&e.jsx("span",{className:"text-green-600",children:"✓"})]}),e.jsxs("div",{className:`flex items-center gap-2 text-lg font-medium ${l.blue_barge_rp?"text-foreground":"text-muted-foreground/50"}`,children:[e.jsx("span",{children:"Barge"}),l.blue_barge_rp&&e.jsx("span",{className:"text-green-600",children:"✓"})]})]})})]}),e.jsx("div",{className:"flex items-center justify-end gap-3",children:i?e.jsx("div",{onClick:n=>n.stopPropagation(),children:i}):null})]})});return l.id?e.jsx(w,{to:`/matches/details/${l.id}`,className:"block no-underline",children:f}):f});function L({match:x,right:l,showRelativeTime:i=!1,dense:m=!1}){return x?x.red_score!==void 0&&x.red_score!==null&&x.blue_score!==void 0&&x.blue_score!==null?e.jsx(S,{match:x,right:l,dense:m}):e.jsx(R,{match:x,right:l,showRelativeTime:i,dense:m}):null}function k(){const{lastUpdated:x,isLoading:l,error:i}=y();return i?e.jsxs("div",{className:"text-xs text-red-600 bg-red-50 px-2 py-1 rounded",children:["Error: ",i]}):l?e.jsx("div",{className:"text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded",children:"Updating..."}):x?e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Last updated: ",x.toLocaleTimeString()]}):null}function T(){return e.jsx(p,{className:"hover:shadow-md transition-shadow duration-200",children:e.jsx(v,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(b,{className:"h-6 w-16 mb-1"}),e.jsx(b,{className:"h-4 w-12"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(b,{className:"h-8 w-8 rounded-full mx-auto mb-1"}),e.jsx(b,{className:"h-4 w-16"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(b,{className:"h-6 w-8 mb-1"}),e.jsx(b,{className:"h-3 w-12"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(b,{className:"h-8 w-8 rounded-full mx-auto mb-1"}),e.jsx(b,{className:"h-4 w-16"})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx(b,{className:"h-5 w-20 mb-1"}),e.jsx(b,{className:"h-4 w-16"})]})]})})})}const J=N.memo(function(){const{matches:l,isLoading:i,error:m}=y(),{alliances:d,isLoading:t,error:o}=A(),u=i||t,s=m||o,a=N.useMemo(()=>{const r=new Map;return d.forEach(f=>{r.set(f.id,f)}),r},[d]),c=N.useMemo(()=>l.map(r=>({...r,redAlliance:r.red_alliance_id?a.get(r.red_alliance_id):null,blueAlliance:r.blue_alliance_id?a.get(r.blue_alliance_id):null})),[l,a]);return u?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Matches"}),e.jsx(k,{})]}),e.jsx("div",{className:"grid gap-3",children:e.jsx("div",{className:"grid gap-2",children:Array.from({length:6}).map((r,f)=>e.jsx(T,{},f))})})]}):s?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Matches"}),e.jsx(k,{})]}),e.jsxs("div",{className:"text-center py-12",children:[e.jsxs("p",{className:"text-red-600 text-lg",children:["Error: ",s]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors",children:"Retry"})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Matches"}),e.jsx(k,{})]}),e.jsx("div",{className:"grid gap-3",children:l.length===0?e.jsx("p",{className:"text-muted-foreground",children:"No matches yet. Use the Schedule page to create matches."}):e.jsx("ul",{className:"grid gap-2",children:c.map(r=>e.jsx("li",{children:e.jsx(L,{match:r,showRelativeTime:!0})},r.id))})})]})});export{J as default};
