import{j as o,w as h}from"./ui-vendor-CDBhOMS0.js";import{r as a}from"./react-vendor-CNeAGCso.js";import{s as w}from"./index-BKCnwC9K.js";function b({...t}){return o.jsx(h,{"data-slot":"aspect-ratio",...t})}const u=new Map,E=300*1e3,R=120*1e3;setInterval(()=>{const t=Date.now();for(const[e,s]of u.entries())s.expiresAt<t&&u.delete(e)},E);function j(t){const e="/robots/",s=t.indexOf(e);return s===-1?null:t.slice(s+e.length)}async function _(t){const e=j(t);if(!e)return t;const s=u.get(t),c=Date.now();if(s&&s.expiresAt>c+R)return s.url;try{const{data:r}=await w.storage.from("robots").createSignedUrl(e,3600);if(r?.signedUrl)return u.set(t,{url:r.signedUrl,expiresAt:c+3600*1e3}),r.signedUrl}catch(r){console.warn("Failed to generate signed URL:",r)}return t}const C=a.memo(function({team:e,className:s,ratio:c=1}){const[r,d]=a.useState(null),[x,n]=a.useState(!0),[p,l]=a.useState(!1),g=a.useCallback(async m=>{if(!m){d(null),n(!1);return}try{n(!0),l(!1);const i=await _(m);if(i){const f=new Image;f.onload=()=>{d(i),n(!1)},f.onerror=()=>{l(!0),n(!1)},f.src=i}else l(!0),n(!1)}catch(i){console.warn("Failed to load robot image:",i),l(!0),n(!1)}},[]);return a.useEffect(()=>{e.robot_image_url?g(e.robot_image_url):(d(null),n(!1),l(!1))},[e.robot_image_url,g]),o.jsx(b,{ratio:c,className:s,children:x?o.jsx("div",{className:"h-full w-full grid place-items-center bg-muted animate-pulse",children:o.jsx("div",{className:"text-2xl font-semibold text-muted-foreground",children:e.number})}):p||!r?o.jsx("div",{className:"h-full w-full grid place-items-center bg-muted",children:o.jsx("div",{className:"text-2xl font-semibold",children:e.number})}):o.jsx("img",{src:r,alt:`${e.number} ${e.name}`,className:"h-full w-full object-cover transition-opacity duration-200",loading:"lazy",decoding:"async"})})});export{b as A,C as R};
